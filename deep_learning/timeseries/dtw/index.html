
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Blog about life, when life is about research." name="description"/>
<meta content="Research" name="keywords"/>
<meta content="Pc Ng" name="author"/>
<link href="https://pc-ng.github.io/deep_learning/timeseries/dtw/" rel="canonical"/>
<!-- <link rel="icon" href="../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.2"> -->
<title>Dynamic Time Warping - Pc's Blog</title>
<link href="../../../assets/stylesheets/main.6f955dcd.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.ef6f36e2.min.css" rel="stylesheet"/>
<meta content="#4cae4f" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Noto+Serif:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Noto Serif";--md-code-font-family:"Roboto Mono"}</style>
<link href="../../../assets/extra.css" rel="stylesheet"/>
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-129545199-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script async="" data-ad-client="ca-pub-9658356171910088" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9658356171910088"></script>
<meta content="website" property="og:type"/>
<meta content="Pc's Blog - Dynamic Time Warping" property="og:title"/>
<meta content="Blog about life, when life is about research." property="og:description"/>
<meta content="https://pc-ng.github.io/deep_learning/timeseries/dtw/" property="og:url"/>
<meta content="https://pc-ng.github.io/assets/banner.jpg" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="1080" property="og:image:width"/>
<meta content="568" property="og:image:height"/>
<script async="" data-ad-client="ca-pub-9658356171910088" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9658356171910088"></script>
</head>
<body data-md-color-accent="" data-md-color-primary="green" data-md-color-scheme="" dir="ltr">
<script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#warping-function">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Pc's Blog" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Pc's Blog">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M296 464h-56V338.78l168.74-168.73c15.52-15.52 4.53-42.05-17.42-42.05H24.68c-21.95 0-32.94 26.53-17.42 42.05L176 338.78V464h-56c-22.09 0-40 17.91-40 40 0 4.42 3.58 8 8 8h240c4.42 0 8-3.58 8-8 0-22.09-17.91-40-40-40zM432 0c-62.61 0-115.35 40.2-135.18 96h52.54c16.65-28.55 47.27-48 82.64-48 52.93 0 96 43.06 96 96s-43.07 96-96 96c-14.04 0-27.29-3.2-39.32-8.64l-35.26 35.26C379.23 279.92 404.59 288 432 288c79.53 0 144-64.47 144-144S511.53 0 432 0z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Pc's Blog
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Dynamic Time Warping
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
      Home
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../blog/research/">
        Blog
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../bluetooth/bluetooth/">
        Bluetooth
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../../">
        Deep learning
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../programming/matlab/">
        Programming
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../tags/">
      Tags
    </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Pc's Blog" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Pc's Blog">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M296 464h-56V338.78l168.74-168.73c15.52-15.52 4.53-42.05-17.42-42.05H24.68c-21.95 0-32.94 26.53-17.42 42.05L176 338.78V464h-56c-22.09 0-40 17.91-40 40 0 4.42 3.58 8 8 8h240c4.42 0 8-3.58 8-8 0-22.09-17.91-40-40-40zM432 0c-62.61 0-115.35 40.2-135.18 96h52.54c16.65-28.55 47.27-48 82.64-48 52.93 0 96 43.06 96 96s-43.07 96-96 96c-14.04 0-27.29-3.2-39.32-8.64l-35.26 35.26C379.23 279.92 404.59 288 432 288c79.53 0 144-64.47 144-144S511.53 0 432 0z"></path></svg>
</a>
    Pc's Blog
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
        Blog
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Blog" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Blog
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blog/research/">
        Research
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2">
        Setup blog
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Setup blog" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
          Setup blog
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blog/setup_blog/install_and_configure/">
        Install and configure
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blog/setup_blog/markdown_syntax/">
        Markdown syntax
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blog/setup_blog/mkdocs_plugins/">
        MkDocs plugins
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blog/setup_blog/customize_theme/">
        Customize theme
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blog/setup_blog/print_to_pdf/">
        Print to PDF
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blog/tools/jupyter_lab_virtual_env/2021-05-13-jupyterLabVirtualEnv/">
        Adding Virtual Environment to Jupyter Lab
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
        Bluetooth
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Bluetooth" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Bluetooth
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../bluetooth/bluetooth/">
        About Bluetooth
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../bluetooth/contact_tracing/2021-04-15-contactTracing/">
        Smart Contact Tracing Project at University of Guelph
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
        Deep learning
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Deep learning" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Deep learning
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../">
        Deep Learning
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Dynamic Time Warping
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Dynamic Time Warping
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#warping-function">
    Warping Function
  </a>
<nav aria-label="Warping Function" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-monotonicity">
    1. Monotonicity
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-continuity">
    2. Continuity
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-boundary-conditions">
    3. Boundary Conditions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-warping-window">
    4. Warping Window
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-slope-constraint">
    5. Slope Constraint
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamic-programming">
    Dynamic Programming
  </a>
<nav aria-label="Dynamic Programming" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#example">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementation">
    Implementation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#wrap-up-the-implementation-with-function">
    Wrap Up the Implementation with function
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#summary">
    Summary
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5">
        Programming
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Programming" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          Programming
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../programming/matlab/">
        Matlab
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" id="__nav_5_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2">
        Python
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Python" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
          Python
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../programming/python/2021-04-18-flattenRavel/">
        Flatten vs Ravel functions in Numpy
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../programming/python/histogramVis/">
        Visualize Data Distribution with Histogram
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../tags/">
        Tags
      </a>
</li>
</ul>
</nav>
<div class="tag-cloud-nav">
<br/>
<br/>
<br/>
<div style="font-weight:700; font-size:.7rem; margin:0 0.6rem;">
<label>Tag cloud</label>
</div>
<div style="padding: 0.4rem 0.6rem;">
<div class="tag-cloud">
<a class="tag" href="https://pc-ng.github.io/tags/#jinja">
<span class="tag-name" style="font-size:0.75rem;color:DarkBlue;">jinja
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Algorithm">
<span class="tag-name" style="font-size:0.75rem;color:DarkRed;">Algorithm
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#JupyterLab">
<span class="tag-name" style="font-size:0.75rem;color:DarkMagenta;">JupyterLab
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#BLE">
<span class="tag-name" style="font-size:0.75rem;color:DarkSlateGray;">BLE
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#python">
<span class="tag-name" style="font-size:1.0rem;color:DarkSlateGray;">python
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Matplotlib">
<span class="tag-name" style="font-size:0.75rem;color:DarkSlateBlue;">Matplotlib
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Numpy">
<span class="tag-name" style="font-size:0.75rem;color:DarkRed;">Numpy
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#markdown">
<span class="tag-name" style="font-size:0.75rem;color:DarkGreen;">markdown
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#research">
<span class="tag-name" style="font-size:0.75rem;color:DarkCyan;">research
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Bluetooth">
<span class="tag-name" style="font-size:0.75rem;color:DarkSlateBlue;">Bluetooth
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#contact tracing">
<span class="tag-name" style="font-size:0.75rem;color:DarkOliveGreen;">contact tracing
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Matlab">
<span class="tag-name" style="font-size:0.75rem;color:DarkOrchid;">Matlab
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Virtual Environment">
<span class="tag-name" style="font-size:0.75rem;color:DarkTurquoise;">Virtual Environment
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Python">
<span class="tag-name" style="font-size:1.0rem;color:DarkTurquoise;">Python
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Seaborn">
<span class="tag-name" style="font-size:0.75rem;color:DarkOrchid;">Seaborn
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#mkdocs">
<span class="tag-name" style="font-size:1.5rem;color:DarkViolet;">mkdocs
            </span>
<sup class="tag-count">4</sup>
</a>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#warping-function">
    Warping Function
  </a>
<nav aria-label="Warping Function" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-monotonicity">
    1. Monotonicity
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-continuity">
    2. Continuity
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-boundary-conditions">
    3. Boundary Conditions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-warping-window">
    4. Warping Window
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-slope-constraint">
    5. Slope Constraint
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamic-programming">
    Dynamic Programming
  </a>
<nav aria-label="Dynamic Programming" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#example">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementation">
    Implementation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#wrap-up-the-implementation-with-function">
    Wrap Up the Implementation with function
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#summary">
    Summary
  </a>
</li>
</ul>
</nav>
<div class="tag-cloud-toc">
<br/>
<br/>
<br/>
<div style="font-weight:700; font-size:.7rem; margin:0 0.6rem;">
<label>Tag cloud</label>
</div>
<div style="padding: 0.4rem 0.6rem;">
<div class="tag-cloud">
<a class="tag" href="https://pc-ng.github.io/tags/#Seaborn">
<span class="tag-name" style="font-size:0.75rem;color:DarkGreen;">Seaborn
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#jinja">
<span class="tag-name" style="font-size:0.75rem;color:DarkSlateBlue;">jinja
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#research">
<span class="tag-name" style="font-size:0.75rem;color:DarkRed;">research
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Python">
<span class="tag-name" style="font-size:1.0rem;color:DarkCyan;">Python
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Virtual Environment">
<span class="tag-name" style="font-size:0.75rem;color:DarkCyan;">Virtual Environment
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Numpy">
<span class="tag-name" style="font-size:0.75rem;color:DarkGoldenrod;">Numpy
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Bluetooth">
<span class="tag-name" style="font-size:0.75rem;color:DarkBlue;">Bluetooth
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Matplotlib">
<span class="tag-name" style="font-size:0.75rem;color:DarkSlateGray;">Matplotlib
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#mkdocs">
<span class="tag-name" style="font-size:1.5rem;color:DarkOrange;">mkdocs
            </span>
<sup class="tag-count">4</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#python">
<span class="tag-name" style="font-size:1.0rem;color:DarkViolet;">python
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#contact tracing">
<span class="tag-name" style="font-size:0.75rem;color:DarkTurquoise;">contact tracing
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Matlab">
<span class="tag-name" style="font-size:0.75rem;color:DarkGoldenrod;">Matlab
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Algorithm">
<span class="tag-name" style="font-size:0.75rem;color:DarkGreen;">Algorithm
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#BLE">
<span class="tag-name" style="font-size:0.75rem;color:DarkOliveGreen;">BLE
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#JupyterLab">
<span class="tag-name" style="font-size:0.75rem;color:DarkOliveGreen;">JupyterLab
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#markdown">
<span class="tag-name" style="font-size:0.75rem;color:DarkSlateBlue;">markdown
            </span>
<sup class="tag-count">1</sup>
</a>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<div class="page-cover">
<h1 class="page-title">Dynamic Time Warping</h1>
<p>
<a class="tag" href="https://pc-ng.github.io/tags/#Algorithm">
<span class="tag-name" style="color:DarkOrchid;">
                        #Algorithm
                    </span>
</a>
</p>
</div>
<div class="toc print-only">
<h2>Table of Content</h2>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#warping-function">
    Warping Function
  </a>
<nav aria-label="Warping Function" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-monotonicity">
    1. Monotonicity
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-continuity">
    2. Continuity
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-boundary-conditions">
    3. Boundary Conditions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-warping-window">
    4. Warping Window
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-slope-constraint">
    5. Slope Constraint
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamic-programming">
    Dynamic Programming
  </a>
<nav aria-label="Dynamic Programming" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#example">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementation">
    Implementation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#wrap-up-the-implementation-with-function">
    Wrap Up the Implementation with function
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#summary">
    Summary
  </a>
</li>
</ul>
</nav>
</div>
<p>Dynamic Time Warping (DTW) is a non-linear similarity computation method that dynamically compute the similarity between time series data when the time indices between data points from time series A and time series B do not match.
Consider the two time series sequences (time series A in green, and time series B in blue) shown in Figure below, these two sequences do not line up in time axis. However, both of them have some similarities in terms of their component shapes.
If traditional distance metrics (e.g., Euclidean distance, Manhattan distance, etc.) are used to compute the distance between the $$i$$th point of time series A with the $$i$$th point of time series B, it will most probably produce a poor similarity score. 
If a non-linear mapping can be used to match the similar shape of two time series even though these two time series sequences are out of phase in the time axis, it will produce a more intuitive similarity measure.
This can be done by warping the time axis of one sequences to align the time axis.</p>
<!-- <img src="twosequences.JPG" alt="drawing" width="200"/> -->
<blockquote>
<p><img alt="drawing" src="twosequences.JPG" width="1000"/> </p>
</blockquote>
<!-- > ![sequences](twosequences.JPG) -->
<div class="caption">
    DTW can efficiently align two time series sequences, allowing a more intuitive similarity measure between out of sync data points.
</div>
<hr/>
<p><br/></p>
<h2 id="warping-function">Warping Function<a class="headerlink" href="#warping-function" title="Permanent link">⚓︎</a></h2>
<p>DTW uses warping function to find the best alignment between two time series sequences.
The objective is to find the path through the grids</p>
<p>$$
P = P_1, P_2, ..., P_s, ..., P_k
$$</p>
<p>$$
P_s = (i, j)
$$</p>
<p>which minimizes the total distance between them.</p>
<blockquote>
<p><img alt="drawing" src="warpinggrid.JPG" width="800"/> </p>
</blockquote>
<div class="caption">
    DTW aims to learn a warping path that dynamically maps the data points of time series A to data points of time series B.
</div>
<p>Let $$A$$ and $$B$$ be time series A and B, respectively, we can compute the time normalized distance between these two time series:</p>
<p>$$
D(A, B) = \frac{\sum_{s=1}^k d(P_s) w_s}{\sum_{s=1}^k w_s}
$$</p>
<p>where $$d(P_s) = d(v_i, v_j)$$ is the distance between value at $$i$$th point $$v_i$$ and value at $$j$$th point $$v_j$$, and $$w_s$$ is the weight coefficient.</p>
<blockquote>
<p><img alt="drawing" src="manypaths.JPG" width="800"/></p>
</blockquote>
<p>Considering the Figure above, there are many possible warping paths through the grid. That's being said, to search for an optimum path, i.e., </p>
<p>$$
P_o = arg\min_P (D(A, B))
$$</p>
<p>can be extremely hard when the grid size is big.</p>
<p>Furthermore, if a single point of time series A can map onto a large subsection of time series B, it will lead to an unintuitive alignment. 
Over the decade, a few constraints have been imposed on the warping function:</p>
<h4 id="1-monotonicity">1. Monotonicity<a class="headerlink" href="#1-monotonicity" title="Permanent link">⚓︎</a></h4>
<blockquote>
<p>Monotonicity ensures that the warping path does not go back in time. 
Given $$P_s = (i, j)$$ and $$P_{s-1} = (i', j')$$,  $$i \leq i'$$ and $$j \leq j'$$ forces the points in $$P$$ to be monotonically spaced in time</p>
</blockquote>
<h4 id="2-continuity">2. Continuity<a class="headerlink" href="#2-continuity" title="Permanent link">⚓︎</a></h4>
<blockquote>
<p>Continuity ensures that the warping path does not jump in time. 
Given $$P_s = (i, j)$$ and $$P_{s-1} = (i', j')$$,  $$i - i' \leq 1$$ and $$j - j' \leq 1$$ restricts the allowable steps in the warping path to adjacent cells.</p>
</blockquote>
<h4 id="3-boundary-conditions">3. Boundary Conditions<a class="headerlink" href="#3-boundary-conditions" title="Permanent link">⚓︎</a></h4>
<blockquote>
<p>The boundary of the warping path states that the part should start at $$P_1 = (1, 1)$$ and end at $$P_s = (m, n)$$, i.e., the warping path needs to start and finish in diagonally opposite corner of the grid. This is important to make sure the warping path does not consider only partial of the sequence.</p>
</blockquote>
<h4 id="4-warping-window">4. Warping Window<a class="headerlink" href="#4-warping-window" title="Permanent link">⚓︎</a></h4>
<blockquote>
<p>Let $$r&gt;0$$ be the length of warping window, $$|i - j| \leq r$$ restricts allowable grid points for the warping path. The warping window ensures that the warping path does not wander too far away from the diagonal. This guarantees that the alignment will not get stuck at similar features.</p>
</blockquote>
<h4 id="5-slope-constraint">5. Slope Constraint<a class="headerlink" href="#5-slope-constraint" title="Permanent link">⚓︎</a></h4>
<blockquote>
<p>Slope constraint ensures that the warping path is neither too steep or too shallow. Let $$q$$ and $$p$$ be the number of steps in the x-direction and y-direction given the grid, then $$\frac{j_{p} - j_{0}}{i_{p} - i_{0}} \leq p$$ and $$\frac{i_{q} - i_{0}}{j_{q} - j_{0}} \leq q$$. That is, after $$q$$ steps in x one must step in y and vice versa.</p>
<p><img alt="drawing" src="constraint.jpg" width="1000"/></p>
</blockquote>
<hr/>
<p><br/></p>
<h2 id="dynamic-programming">Dynamic Programming<a class="headerlink" href="#dynamic-programming" title="Permanent link">⚓︎</a></h2>
<p>Dynamic Programming is an efficient method to find the warping path. 
In general, dynamic programming evaluate the cumulative distance $$\gamma(i, j)$$ based on the distance $d(P_s)$ at the current cell and the minimum of the cumulative distances of the adjacent elements.
Mathematically,   </p>
<p>$$
\gamma(i, j) = d(P_s) + \min {\gamma(i-1, j-1), \gamma(i-1, j), \gamma(i, j-1)}
$$</p>
<p>where $$d(P_s) = d(v_i, v_j)$$ can be calculated by taking the absolute difference between value at $$i$$th point and value at $$j$$point, i.e., $$d(v_i, v_j) = |v_i - v_j|$$</p>
<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">⚓︎</a></h3>
<p>Suppose that we have two time series A and B as follows:</p>
<p>$$
A = [ 3, 2, 2, 3, 5, 5, 6 ]
$$</p>
<p>$$
B = [ 1, 3, 2, 2, 3, 5 ]
$$</p>
<p>First, let's consider point $$P_s = (1,1)$$, i.e., $$i=1$$ and $$j=1$$, the value at  $$i=1$$ is $$v(i=1) = 3$$ and the value at $$j=1$$ is $$v(j=1) = 1$$.
Hence, the absolute distance at point $$P_s = (1,1)$$ is $$d(P_s) = |3-1| = 2$$.
Since the values at the cell above, left and diagonally above $$P_s$$ are all empty, hence, $$\min {\gamma(i-1, j-1), \gamma(i-1, j), \gamma(i, j-1)} = 0$$.
The cumulative distance $$\gamma(i=1, j=1)$$ will be 2, as shown in Figure below.</p>
<blockquote>
<p><img alt="drawing" src="compute1.jpg" width="800"/></p>
</blockquote>
<p>Let's consider another point $$P_s = (4,4)$$, here we have $$v(i=4) = 3$$ and $$v(j=4) = 2$$. 
Hence, the absolute distance at point $$P_s = (4,4)$$ is $$d(P_s) = |3-2| = 1$$.
The values at the adjacent cells (above, left and diagonally above ) are 3, 2 and 2. By taking the minimum value, we have 2. 
So, the cumulative distance $$\gamma(i=4, j=4)$$ will be 3, as shown in Figure below.</p>
<blockquote>
<p><img alt="drawing" src="compute2.jpg" width="800"/></p>
</blockquote>
<p>Figure below shows the final grid (or matrix) with all the value computed.</p>
<blockquote>
<p><img alt="drawing" src="finalcompute.jpg" width="400"/></p>
</blockquote>
<p>The warping path can be obtained by backtracking from the end point to the beginning point as shown below.</p>
<blockquote>
<p><img alt="drawing" src="backtrack.jpg" width="1100"/></p>
</blockquote>
<hr/>
<p><br/></p>
<h2 id="implementation">Implementation<a class="headerlink" href="#implementation" title="Permanent link">⚓︎</a></h2>
<p>Here we will walkthrough a simple implementation of above example in Python.</p>
<p>First, define the two time series A and B</p>
<div class="highlight"><pre><span></span><code><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div>
<p>Initialize a dtw matrix based on the length of A and B, i.e., length of B define the number of rows, and length of A define the number of columns.</p>
<div class="highlight"><pre><span></span><code><span class="n">dtw_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dtw_mat</span><span class="p">)</span>
</code></pre></div>
<p><strong>output</strong>:</p>
<div class="highlight"><pre><span></span><code>[[0. 0. 0. 0. 0. 0. 0.]
[0. 0. 0. 0. 0. 0. 0.]
[0. 0. 0. 0. 0. 0. 0.]
[0. 0. 0. 0. 0. 0. 0.]
[0. 0. 0. 0. 0. 0. 0.]
[0. 0. 0. 0. 0. 0. 0.]]
</code></pre></div>
<p>Now, we need to loop through all element in the dtw matrix, and compute the cumulative distance.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># define the absolute distance function</span>
<span class="n">d</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">choice</span> <span class="o">=</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">choice</span> <span class="o">=</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

            <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dtw_mat</span><span class="p">)</span>
</code></pre></div>
<p><strong>output</strong>:</p>
<div class="highlight"><pre><span></span><code>[[ 2.  3.  4.  6. 10. 14. 19.]
[ 2.  3.  4.  4.  6.  8. 11.]
[ 3.  2.  2.  3.  6.  9. 12.]
[ 4.  2.  2.  3.  6.  9. 13.]
[ 4.  3.  3.  2.  4.  6.  9.]
[ 6.  6.  6.  4.  2.  2.  3.]]
</code></pre></div>
<p>We can find the warping path by backtracking.</p>
<div class="highlight"><pre><span></span><code><span class="n">path</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="k">while</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
        <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">warp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
    <span class="n">warp</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span> 

<span class="nb">print</span><span class="p">(</span><span class="n">warp</span><span class="p">)</span>
</code></pre></div>
<p><strong>output</strong>:</p>
<div class="highlight"><pre><span></span><code>[[1. 0. 0. 0. 0. 0. 0.]
[1. 0. 0. 0. 0. 0. 0.]
[0. 1. 1. 0. 0. 0. 0.]
[0. 0. 1. 0. 0. 0. 0.]
[0. 0. 0. 1. 0. 0. 0.]
[0. 0. 0. 0. 1. 1. 1.]]
</code></pre></div>
<p>Then, we can calculate the normalized distance between time series A and time series B. 
Assume that all the point shares equal weight, i.e., $$w_s=1$$ for all $$P_s$$, then $$D(A,B)$$ can be computed as follows:</p>
<p>$$
D(A,B) = \frac{1}{k} \sum_{s = 1}^k d(P_s)
$$</p>
<p><div class="highlight"><pre><span></span><code><span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">warp</span> <span class="o">*</span> <span class="n">dtw_mat</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Normalized Distance: </span><span class="si">{</span><span class="n">D</span><span class="si">:</span><span class="s1">2f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</code></pre></div>
output:</p>
<div class="highlight"><pre><span></span><code>Normalized Distance: 2.111111
</code></pre></div>
<hr/>
<p><br/></p>
<h2 id="wrap-up-the-implementation-with-function">Wrap Up the Implementation with function<a class="headerlink" href="#wrap-up-the-implementation-with-function" title="Permanent link">⚓︎</a></h2>
<p>We can also define a few functions to handle the DTW matrix computation, get the warping path and also compute the normalized distance. </p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">computed_dtwMat</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">choice</span> <span class="o">=</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">choice</span> <span class="o">=</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

                <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dtw_mat</span>
</code></pre></div>
<p>We can call the above function by providing time series A and time series B as input arguments, and it will return the <code>dtw_mat</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">dtw_mat</span> <span class="o">=</span> <span class="n">computed_dtwMat</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dtw_mat</span><span class="p">)</span>
</code></pre></div>
<p><strong>output</strong>:</p>
<div class="highlight"><pre><span></span><code>[[ 2.  3.  4.  6. 10. 14. 19.]
[ 2.  3.  4.  4.  6.  8. 11.]
[ 3.  2.  2.  3.  6.  9. 12.]
[ 4.  2.  2.  3.  6.  9. 13.]
[ 4.  3.  3.  2.  4.  6.  9.]
[ 6.  6.  6.  4.  2.  2.  3.]]
</code></pre></div>
<p>We can define a function to get the warping path.
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_warpingPath</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="n">dtw_mat</span> <span class="o">=</span> <span class="n">computed_dtwMat</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">while</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtw_mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="n">warp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
        <span class="n">warp</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span> 
<span class="err">```</span><span class="n">python</span>
<span class="n">path</span><span class="p">,</span> <span class="n">warp</span><span class="p">,</span> <span class="n">dtw_matrix</span> <span class="o">=</span> <span class="n">get_warpingPath</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">warp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dtw_mat</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>output</strong>:</p>
<div class="highlight"><pre><span></span><code>[[1. 0. 0. 0. 0. 0. 0.]
[1. 0. 0. 0. 0. 0. 0.]
[0. 1. 1. 0. 0. 0. 0.]
[0. 0. 1. 0. 0. 0. 0.]
[0. 0. 0. 1. 0. 0. 0.]
[0. 0. 0. 0. 1. 1. 1.]]

[[ 2.  3.  4.  6. 10. 14. 19.]
[ 2.  3.  4.  4.  6.  8. 11.]
[ 3.  2.  2.  3.  6.  9. 12.]
[ 4.  2.  2.  3.  6.  9. 13.]
[ 4.  3.  3.  2.  4.  6.  9.]
[ 6.  6.  6.  4.  2.  2.  3.]]
</code></pre></div>
<p>Finally, we can have a function to compute the normalized distance.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">normalized_dist</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="n">path</span><span class="p">,</span> <span class="n">warp</span><span class="p">,</span> <span class="n">dtw_matrix</span> <span class="o">=</span> <span class="n">get_warpingPath</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">warp</span> <span class="o">*</span> <span class="n">dtw_mat</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">D</span>
</code></pre></div>
<p>By calling the function <code>normalized_dist</code>, it will return us the normalized distance between time series A and time series B.
<div class="highlight"><pre><span></span><code><span class="n">D</span> <span class="o">=</span> <span class="n">normalized_dist</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Normalized Distance: </span><span class="si">{</span><span class="n">D</span><span class="si">:</span><span class="s1">2f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</code></pre></div>
<strong>output</strong>:</p>
<div class="highlight"><pre><span></span><code>Normalized Distance: 2.111111
</code></pre></div>
<hr/>
<p><br/></p>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">⚓︎</a></h2>
<p>A python script containing all the above functions is provided <a href="https://github.com/pc-ng/dtw">here</a>
You can also refer to the example notebook <a href="https://github.com/pc-ng/dtw/blob/master/dtw_example.ipynb">here</a> on how to apply those functions.</p>
<p>There is also a useful <code>dtw-python</code> package provided by Toni dot Giorgino. You can visit his <a href="https://dynamictimewarping.github.io/python/#online-documentation">site</a> for more information about <code>dtw-python</code> package.
You can also install the package by issuing the following command: <code>pip install dtw-python</code>.</p>
<p>DTW is available in Matlab through the Signal Processing Toolbox. For more information about using DTW with Matlab, check out the Matlab documentation about DTW <a href="https://www.mathworks.com/help/signal/ref/dtw.html">here</a>.</p>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" data-md-state="hidden" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path></svg>
</a>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a class="md-footer__link md-footer__link--prev" href="../../" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Deep Learning
            </div>
</div>
</a>
<a class="md-footer__link md-footer__link--next" href="../../../programming/matlab/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Matlab
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Perfectly Imperfect <div style="display:none"><div>
</div>
</div>
<div style="color: var(--md-footer-fg-color--lighter);">
        Pc Ng © <script>document.write(new Date().getFullYear())</script>.  All rights reserved.
    </div>
</div>
</div>
<div class="md-footer-social">
<a class="md-footer-social__link" href="https://github.com/pc-ng" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://www.linkedin.com/in/pc-ng-3b45072b" rel="noopener" target="_blank" title="www.linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
<script src="../../../assets/javascripts/bundle.4ea5477f.min.js"></script>
<script src="../../../assets/extra.js"></script>
</body>
</html>