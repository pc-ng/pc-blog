
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Blog about life, when life is about research." name="description"/>
<meta content="Research" name="keywords"/>
<meta content="Pc Ng" name="author"/>
<link href="https://pc-ng.github.io/artificial_intelligence/computer_vision/face_detection_opencv/face_detection_opencv/" rel="canonical"/>
<!-- <link rel="icon" href="../../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.2"> -->
<title>Face Detection with OpenCV - Pc's Blog</title>
<link href="../../../../assets/stylesheets/main.6f955dcd.min.css" rel="stylesheet"/>
<link href="../../../../assets/stylesheets/palette.ef6f36e2.min.css" rel="stylesheet"/>
<meta content="#4cae4f" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Noto+Serif:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Noto Serif";--md-code-font-family:"Roboto Mono"}</style>
<link href="../../../../assets/extra.css" rel="stylesheet"/>
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-129545199-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script async="" data-ad-client="ca-pub-9658356171910088" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9658356171910088"></script>
<meta content="website" property="og:type"/>
<meta content="Pc's Blog - Face Detection with OpenCV" property="og:title"/>
<meta content="Blog about life, when life is about research." property="og:description"/>
<meta content="https://pc-ng.github.io/artificial_intelligence/computer_vision/face_detection_opencv/face_detection_opencv/" property="og:url"/>
<meta content="https://pc-ng.github.io/assets/banner.jpg" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="1080" property="og:image:width"/>
<meta content="568" property="og:image:height"/>
<script async="" data-ad-client="ca-pub-9658356171910088" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9658356171910088"></script>
</head>
<body data-md-color-accent="" data-md-color-primary="green" data-md-color-scheme="" dir="ltr">
<script>function __prefix(e){return new URL("../../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#get-the-haar-cascade-xml-files">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Pc's Blog" class="md-header__button md-logo" data-md-component="logo" href="../../../.." title="Pc's Blog">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M296 464h-56V338.78l168.74-168.73c15.52-15.52 4.53-42.05-17.42-42.05H24.68c-21.95 0-32.94 26.53-17.42 42.05L176 338.78V464h-56c-22.09 0-40 17.91-40 40 0 4.42 3.58 8 8 8h240c4.42 0 8-3.58 8-8 0-22.09-17.91-40-40-40zM432 0c-62.61 0-115.35 40.2-135.18 96h52.54c16.65-28.55 47.27-48 82.64-48 52.93 0 96 43.06 96 96s-43.07 96-96 96c-14.04 0-27.29-3.2-39.32-8.64l-35.26 35.26C379.23 279.92 404.59 288 432 288c79.53 0 144-64.47 144-144S511.53 0 432 0z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Pc's Blog
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Face Detection with OpenCV
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../..">
      Home
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../../../">
        Artificial intelligence
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../biometric_signals/aboutheartrate/aboutheartrate/">
        Biometric signals
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../blog/research/">
        Blog
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../bluetooth/bluetooth/">
        Bluetooth
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../programming/matlab/">
        Programming
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../tags/">
      Tags
    </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Pc's Blog" class="md-nav__button md-logo" data-md-component="logo" href="../../../.." title="Pc's Blog">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M296 464h-56V338.78l168.74-168.73c15.52-15.52 4.53-42.05-17.42-42.05H24.68c-21.95 0-32.94 26.53-17.42 42.05L176 338.78V464h-56c-22.09 0-40 17.91-40 40 0 4.42 3.58 8 8 8h240c4.42 0 8-3.58 8-8 0-22.09-17.91-40-40-40zM432 0c-62.61 0-115.35 40.2-135.18 96h52.54c16.65-28.55 47.27-48 82.64-48 52.93 0 96 43.06 96 96s-43.07 96-96 96c-14.04 0-27.29-3.2-39.32-8.64l-35.26 35.26C379.23 279.92 404.59 288 432 288c79.53 0 144-64.47 144-144S511.53 0 432 0z"></path></svg>
</a>
    Pc's Blog
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
        Artificial intelligence
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Artificial intelligence" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Artificial intelligence
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../">
        Deep Learning
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Face Detection with OpenCV
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Face Detection with OpenCV
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#get-the-haar-cascade-xml-files">
    Get the Haar cascade xml Files
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-load-the-haar-cascade-files">
    Step 1: Load the haar cascade files
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-load-the-image">
    Step 2: Load the image
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-face-detection">
    Step 3: Face Detection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-eye-detection">
    Step 4: Eye Detection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-faces">
    Multiple Faces
  </a>
<nav aria-label="Multiple Faces" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#repeat-the-face-detection-and-eye-detection">
    Repeat the Face Detection and Eye Detection
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#note">
    Note
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../timeseries/dtw/">
        Dynamic Time Warping
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
        Biometric signals
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Biometric signals" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Biometric signals
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../biometric_signals/aboutheartrate/aboutheartrate/">
        Heart Rate
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../biometric_signals/aboutecg/aboutecg/">
        Heart Rate Measurement from ECG
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
        Blog
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Blog" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Blog
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../blog/research/">
        Research
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2">
        Tools
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Tools" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
          Tools
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../blog/tools/diplaying-image-with-opencv-inside-jupyterlab/Displaying-Image-with-OpenCV-inside-JupyterLab/">
        Displaying an Image with OpenCV inside Jupyter Lab
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../blog/tools/jupyter_lab_virtual_env/2021-05-13-jupyterLabVirtualEnv/">
        Adding Virtual Environment to Jupyter Lab
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5">
        Bluetooth
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Bluetooth" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          Bluetooth
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../bluetooth/bluetooth/">
        About Bluetooth
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../bluetooth/contact_tracing/2021-04-15-contactTracing/">
        Smart Contact Tracing Project at University of Guelph
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6">
        Programming
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Programming" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          Programming
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../programming/matlab/">
        Matlab
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2" id="__nav_6_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_2">
        Python
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Python" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_2">
<span class="md-nav__icon md-icon"></span>
          Python
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../programming/python/2021-04-18-flattenRavel/">
        Flatten vs Ravel functions in Numpy
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../programming/python/histogramVis/">
        Visualize Data Distribution with Histogram
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../tags/">
        Tags
      </a>
</li>
</ul>
</nav>
<div class="tag-cloud-nav">
<br/>
<br/>
<br/>
<div style="font-weight:700; font-size:.7rem; margin:0 0.6rem;">
<label>Tag cloud</label>
</div>
<div style="padding: 0.4rem 0.6rem;">
<div class="tag-cloud">
<a class="tag" href="https://pc-ng.github.io/tags/#Algorithm">
<span class="tag-name" style="font-size:1.0rem;color:DarkCyan;">Algorithm
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Numpy">
<span class="tag-name" style="font-size:1.0rem;color:DarkGoldenrod;">Numpy
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#HRV">
<span class="tag-name" style="font-size:1.5rem;color:DarkCyan;">HRV
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Matplotlib">
<span class="tag-name" style="font-size:1.0rem;color:DarkGreen;">Matplotlib
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#JupyterLab">
<span class="tag-name" style="font-size:1.5rem;color:DarkOrchid;">JupyterLab
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#contact tracing">
<span class="tag-name" style="font-size:1.0rem;color:DarkGoldenrod;">contact tracing
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#PPG">
<span class="tag-name" style="font-size:1.0rem;color:DarkGoldenrod;">PPG
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Face Detection">
<span class="tag-name" style="font-size:1.0rem;color:DarkSlateBlue;">Face Detection
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#BLE">
<span class="tag-name" style="font-size:1.0rem;color:DarkTurquoise;">BLE
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#HR">
<span class="tag-name" style="font-size:1.5rem;color:DarkSlateGray;">HR
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Bluetooth">
<span class="tag-name" style="font-size:1.0rem;color:DarkSlateBlue;">Bluetooth
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#ECG">
<span class="tag-name" style="font-size:1.5rem;color:DarkRed;">ECG
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Matlab">
<span class="tag-name" style="font-size:1.0rem;color:DarkCyan;">Matlab
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Virtual Environment">
<span class="tag-name" style="font-size:1.0rem;color:DarkTurquoise;">Virtual Environment
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#research">
<span class="tag-name" style="font-size:1.0rem;color:DarkOrange;">research
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Python">
<span class="tag-name" style="font-size:1.5rem;color:DarkMagenta;">Python
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Seaborn">
<span class="tag-name" style="font-size:1.0rem;color:DarkSlateGray;">Seaborn
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#OpenCV">
<span class="tag-name" style="font-size:1.5rem;color:DarkSlateBlue;">OpenCV
            </span>
<sup class="tag-count">2</sup>
</a>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#get-the-haar-cascade-xml-files">
    Get the Haar cascade xml Files
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-load-the-haar-cascade-files">
    Step 1: Load the haar cascade files
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-load-the-image">
    Step 2: Load the image
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-face-detection">
    Step 3: Face Detection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-eye-detection">
    Step 4: Eye Detection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-faces">
    Multiple Faces
  </a>
<nav aria-label="Multiple Faces" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#repeat-the-face-detection-and-eye-detection">
    Repeat the Face Detection and Eye Detection
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#note">
    Note
  </a>
</li>
</ul>
</nav>
<div class="tag-cloud-toc">
<br/>
<br/>
<br/>
<div style="font-weight:700; font-size:.7rem; margin:0 0.6rem;">
<label>Tag cloud</label>
</div>
<div style="padding: 0.4rem 0.6rem;">
<div class="tag-cloud">
<a class="tag" href="https://pc-ng.github.io/tags/#research">
<span class="tag-name" style="font-size:1.0rem;color:DarkRed;">research
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Virtual Environment">
<span class="tag-name" style="font-size:1.0rem;color:DarkBlue;">Virtual Environment
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Algorithm">
<span class="tag-name" style="font-size:1.0rem;color:DarkGreen;">Algorithm
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Matplotlib">
<span class="tag-name" style="font-size:1.0rem;color:DarkGoldenrod;">Matplotlib
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#JupyterLab">
<span class="tag-name" style="font-size:1.5rem;color:DarkSlateGray;">JupyterLab
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#ECG">
<span class="tag-name" style="font-size:1.5rem;color:DarkMagenta;">ECG
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Matlab">
<span class="tag-name" style="font-size:1.0rem;color:DarkOrange;">Matlab
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Face Detection">
<span class="tag-name" style="font-size:1.0rem;color:DarkOrchid;">Face Detection
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#HR">
<span class="tag-name" style="font-size:1.5rem;color:DarkViolet;">HR
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#PPG">
<span class="tag-name" style="font-size:1.0rem;color:DarkCyan;">PPG
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Bluetooth">
<span class="tag-name" style="font-size:1.0rem;color:DarkGreen;">Bluetooth
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Python">
<span class="tag-name" style="font-size:1.5rem;color:DarkMagenta;">Python
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#OpenCV">
<span class="tag-name" style="font-size:1.5rem;color:DarkOrchid;">OpenCV
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#HRV">
<span class="tag-name" style="font-size:1.5rem;color:DarkOrchid;">HRV
            </span>
<sup class="tag-count">2</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Numpy">
<span class="tag-name" style="font-size:1.0rem;color:DarkGoldenrod;">Numpy
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#contact tracing">
<span class="tag-name" style="font-size:1.0rem;color:DarkSlateGray;">contact tracing
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#BLE">
<span class="tag-name" style="font-size:1.0rem;color:DarkBlue;">BLE
            </span>
<sup class="tag-count">1</sup>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#Seaborn">
<span class="tag-name" style="font-size:1.0rem;color:DarkRed;">Seaborn
            </span>
<sup class="tag-count">1</sup>
</a>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<div class="page-cover">
<h1 class="page-title">Face Detection with OpenCV</h1>
<p class="md-source-date">
<hr class="print-only"/>
<small>
                        Date: 2021-05-29 16:37:11,  by Pc Ng
                    </small>
</p>
<p>
<a class="tag" href="https://pc-ng.github.io/tags/#Face Detection">
<span class="tag-name" style="color:DarkOrange;">
                        #Face Detection
                    </span>
</a>
<a class="tag" href="https://pc-ng.github.io/tags/#OpenCV">
<span class="tag-name" style="color:DarkOliveGreen;">
                        #OpenCV
                    </span>
</a>
</p>
</div>
<div class="toc print-only">
<h2>Table of Content</h2>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#get-the-haar-cascade-xml-files">
    Get the Haar cascade xml Files
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-load-the-haar-cascade-files">
    Step 1: Load the haar cascade files
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-load-the-image">
    Step 2: Load the image
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-face-detection">
    Step 3: Face Detection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-eye-detection">
    Step 4: Eye Detection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-faces">
    Multiple Faces
  </a>
<nav aria-label="Multiple Faces" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#repeat-the-face-detection-and-eye-detection">
    Repeat the Face Detection and Eye Detection
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#note">
    Note
  </a>
</li>
</ul>
</nav>
</div>
<p>If you were given a photo and asked to find all the faces in the photo, I believe you can do it in just a few seconds. 
While it is easy for human to detect the face, face detection is still a challenging problem in computer vision. </p>
<p>In this post, we will look at how we can perform face detection as well as eye detection with openCV. OpenCV provides a feature-based cascade classifier that can localize faces given a photo. More information about the face detection with OpenCV can be found in this <a href="https://ieeexplore.ieee.org/document/990517">paper</a> published in CVPR 2001.</p>
<h3 id="get-the-haar-cascade-xml-files">Get the Haar cascade xml Files<a class="headerlink" href="#get-the-haar-cascade-xml-files" title="Permanent link">⚓︎</a></h3>
<p>You can downlaod the haar cascade xml file from this <a href="https://github.com/opencv/opencv/tree/master/data">link</a>. 
Alternatively, you can find the haar cascade xml files in your opencv package. 
Here is a list of haar cascade files inside the data folder of opencv package.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span> 
<span class="kn">import</span> <span class="nn">cv2</span> 

<span class="n">cv2_base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cv2_base_dir</span><span class="p">,</span> <span class="s1">'data'</span><span class="p">))</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Output:</p>
<div class="highlight"><pre><span></span><code>['haarcascade_eye.xml',
 'haarcascade_eye_tree_eyeglasses.xml',
 'haarcascade_frontalcatface.xml',
 'haarcascade_frontalcatface_extended.xml',
 'haarcascade_frontalface_alt.xml',
 'haarcascade_frontalface_alt2.xml',
 'haarcascade_frontalface_alt_tree.xml',
 'haarcascade_frontalface_default.xml',
 'haarcascade_fullbody.xml',
 'haarcascade_lefteye_2splits.xml',
 'haarcascade_licence_plate_rus_16stages.xml',
 'haarcascade_lowerbody.xml',
 'haarcascade_profileface.xml',
 'haarcascade_righteye_2splits.xml',
 'haarcascade_russian_plate_number.xml',
 'haarcascade_smile.xml',
 'haarcascade_upperbody.xml',
 '__init__.py',
 '__pycache__']
</code></pre></div>
</div>
<h3 id="step-1-load-the-haar-cascade-files">Step 1: Load the haar cascade files<a class="headerlink" href="#step-1-load-the-haar-cascade-files" title="Permanent link">⚓︎</a></h3>
<p>We need two cascade files: one for face detection, another for eye detection. </p>
<ol>
<li>use <code>haarcascade_frontalcatface.xml</code> for frontal face detection</li>
<li>use <code>haarcascade_eye.xml</code> for eye detection</li>
</ol>
<p>First, locate the path to the xml file, and then use the <code>CascadeClassifier</code> function to load the file.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># path to haarcascade_frontalcatface.xml and haarcascade_eye.xml</span>
<span class="n">face_xml</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cv2_base_dir</span><span class="p">,</span> <span class="s1">'data'</span><span class="p">,</span> <span class="s1">'haarcascade_frontalface_default.xml'</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'</span><span class="se">\\</span><span class="s1">'</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">)</span>
<span class="n">eye_xml</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cv2_base_dir</span><span class="p">,</span> <span class="s1">'data'</span><span class="p">,</span> <span class="s1">'haarcascade_eye.xml'</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'</span><span class="se">\\</span><span class="s1">'</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">)</span>

<span class="c1"># load the files </span>
<span class="n">face_classifier</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CascadeClassifier</span><span class="p">(</span><span class="n">face_xml</span><span class="p">)</span>
<span class="n">eye_classifier</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CascadeClassifier</span><span class="p">(</span><span class="n">eye_xml</span><span class="p">)</span>
</code></pre></div>
<h3 id="step-2-load-the-image">Step 2: Load the image<a class="headerlink" href="#step-2-load-the-image" title="Permanent link">⚓︎</a></h3>
<p>We can use the <code>imread</code> function to read an image. Suppose that we have an image named <code>olivia1.jpg</code> in the same directory, we can read the image by specifying the image name.
This image shows the self-protrait of Olivia, and it is provided freely by Olivia. You can check out more about her projects <a href="https://sites.google.com/view/olivialiu/projects?authuser=0">here</a>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># read the image</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">'olivia1.jpg'</span><span class="p">)</span>
</code></pre></div>
<p>We can display the image using the <code>imshow</code> function from OpenCV. This will open up a new window with the image. If you are using Jupyter Notebook, and would like to display the image within the Jupyter Notebook environment, you can use the method describe <a href="https://pc-ng.github.io/pc-blog/blog/tools/diplaying-image-with-opencv-inside-jupyterlab/Displaying-Image-with-OpenCV-inside-JupyterLab/">here</a>. </p>
<p>In this post, we are going to use the Matplotlib library to display the image within Jupyter notebook. Note that Matplotlib shows the image in RGB order, whereas OpenCV reads the image in BGR order. 
So, we need to first convert the order of color channel from BGR to RGB, before calling the <code>imshow</code> function from Matplotlib</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 

<span class="n">image_RGB</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>
<figure><img src="../face_detection_opencv_8_0.svg"/><figcaption>.</figcaption>
</figure>
</p>
<h3 id="step-3-face-detection">Step 3: Face Detection<a class="headerlink" href="#step-3-face-detection" title="Permanent link">⚓︎</a></h3>
<p>We can perform the face detection by using the <code>face_classifier</code> that we defined earlier. Then, we can load the bounding box around the detected face, and display the image with the detected face.</p>
<div class="highlight"><pre><span></span><code><span class="n">faces</span> <span class="o">=</span> <span class="n">face_classifier</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

<span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
    <span class="c1"># get the coordinate of the detected face and its width and height</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">face</span> 

    <span class="c1"># draw the bounding box with the coordinates above</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span>
        <span class="n">img</span><span class="o">=</span> <span class="n">image</span><span class="p">,</span>
        <span class="n">pt1</span><span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
        <span class="n">pt2</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">width</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">height</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
        <span class="n">thickness</span><span class="o">=</span> <span class="mi">2</span>
    <span class="p">)</span>


<span class="c1"># display the image</span>
<span class="n">image_RGB</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>
<figure><img src="../face_detection_opencv_10_0.svg"/><figcaption>.</figcaption>
</figure>
</p>
<h3 id="step-4-eye-detection">Step 4: Eye Detection<a class="headerlink" href="#step-4-eye-detection" title="Permanent link">⚓︎</a></h3>
<p>Similarly, we can use the <code>eye_classifier</code> we loaded earlier to detect the eye.</p>
<div class="highlight"><pre><span></span><code><span class="n">eyes</span> <span class="o">=</span> <span class="n">eye_classifier</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">eye</span> <span class="ow">in</span> <span class="n">eyes</span><span class="p">:</span>
    <span class="c1"># get the coordinate of the detected face and its width and height</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">eye</span> 

    <span class="c1"># draw the bounding box with the coordinates above</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span>
        <span class="n">img</span><span class="o">=</span> <span class="n">image</span><span class="p">,</span>
        <span class="n">pt1</span><span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
        <span class="n">pt2</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">width</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">height</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
        <span class="n">thickness</span><span class="o">=</span> <span class="mi">2</span>
    <span class="p">)</span>


<span class="c1"># display the image</span>
<span class="n">image_RGB</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>
<figure><img src="../face_detection_opencv_12_0.svg"/><figcaption>.</figcaption>
</figure>
</p>
<h2 id="multiple-faces">Multiple Faces<a class="headerlink" href="#multiple-faces" title="Permanent link">⚓︎</a></h2>
<p>What if there are mulitple faces in the photo?
Let's consider the following photo containing Olivia and her friends. </p>
<div class="highlight"><pre><span></span><code><span class="c1"># read the image</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">'olivia2.jpg'</span><span class="p">)</span>

<span class="n">image_RGB</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>
<figure><img src="../face_detection_opencv_14_0.svg"/><figcaption>.</figcaption>
</figure>
</p>
<h3 id="repeat-the-face-detection-and-eye-detection">Repeat the Face Detection and Eye Detection<a class="headerlink" href="#repeat-the-face-detection-and-eye-detection" title="Permanent link">⚓︎</a></h3>
<p>Let's perform the face detection and eye detection with the above photo by repeating the same last two steps described above (i.e., step 3 to step 4)</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Step 3:</span>
<span class="n">faces</span> <span class="o">=</span> <span class="n">face_classifier</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
    <span class="c1"># get the coordinate of the detected face and its width and height</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">face</span> 

    <span class="c1"># draw the bounding box with the coordinates above</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span>
        <span class="n">img</span><span class="o">=</span> <span class="n">image</span><span class="p">,</span>
        <span class="n">pt1</span><span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
        <span class="n">pt2</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">width</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">height</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
        <span class="n">thickness</span><span class="o">=</span> <span class="mi">2</span>
    <span class="p">)</span>


<span class="c1"># display the image</span>
<span class="n">image_RGB</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>
<figure><img src="../face_detection_opencv_16_0.svg"/><figcaption>.</figcaption>
</figure>
</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Step 4</span>
<span class="n">eyes</span> <span class="o">=</span> <span class="n">eye_classifier</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">eye</span> <span class="ow">in</span> <span class="n">eyes</span><span class="p">:</span>
    <span class="c1"># get the coordinate of the detected face and its width and height</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">eye</span> 

    <span class="c1"># draw the bounding box with the coordinates above</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span>
        <span class="n">img</span><span class="o">=</span> <span class="n">image</span><span class="p">,</span>
        <span class="n">pt1</span><span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
        <span class="n">pt2</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">width</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">height</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
        <span class="n">thickness</span><span class="o">=</span> <span class="mi">2</span>
    <span class="p">)</span>


<span class="c1"># display the image</span>
<span class="n">image_RGB</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_RGB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>
<figure><img src="../face_detection_opencv_17_0.svg"/><figcaption>.</figcaption>
</figure>
</p>
<h2 id="note">Note<a class="headerlink" href="#note" title="Permanent link">⚓︎</a></h2>
<p>We used different <code>scaleFactor</code> for two cases. <code>scaleFactor</code> is a parameter specifying how much the image size is reduced at each image scale.  The face and eye models specified by <code>haarcascade_frontalcatface.xml</code> and <code>haarcascade_eye.xml</code>, respectively, has a fixed size defined during training. By scaling the input image, we can resize a larger face to a smaller one, making it detectable by the algorithm. For example, if we set <code>scaleFactor = 1.3</code>, it will scale the picture 30% down to try to match the faces / eyes better.</p>
<p>There are other parameters we can set with <code>detectMultiScale</code> function, more details about this function and those configurable parameter can be found <a href="https://docs.opencv.org/3.4/d1/de5/classcv_1_1CascadeClassifier.html">here</a>.</p>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" data-md-state="hidden" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path></svg>
</a>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a class="md-footer__link md-footer__link--prev" href="../../../" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Deep Learning
            </div>
</div>
</a>
<a class="md-footer__link md-footer__link--next" href="../../../timeseries/dtw/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Dynamic Time Warping
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Perfectly Imperfect <div style="display:none"><div>
</div>
</div>
<div style="color: var(--md-footer-fg-color--lighter);">
        Pc Ng © <script>document.write(new Date().getFullYear())</script>.  All rights reserved.
    </div>
</div>
</div>
<div class="md-footer-social">
<a class="md-footer-social__link" href="https://github.com/pc-ng" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://www.linkedin.com/in/pc-ng-3b45072b" rel="noopener" target="_blank" title="www.linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.top", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
<script src="../../../../assets/javascripts/bundle.4ea5477f.min.js"></script>
<script src="../../../../assets/extra.js"></script>
<script src="../../../../assets/config.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>